# 透析供給装置薬液補充アプリ 要件定義書

## 1. 機能要件

### 1.1 基本機能

#### 1.1.1 薬液選択機能
- **要件ID**: REQ-001
- **説明**: 補充する薬液の種類を選択する機能
- **詳細**:
  - 次亜塩素酸ナトリウム選択ボタン
  - 酢酸選択ボタン
  - 選択状態の視覚的表示
  - 補充開始ボタン（選択後に有効化）

#### 1.1.2 カメラ機能
- **要件ID**: REQ-002
- **説明**: リアルタイムカメラ映像の取得と表示
- **詳細**:
  - カメラの自動起動
  - リアルタイム映像ストリーミング
  - 映像の安定表示
  - カメラ権限の適切な管理

#### 1.1.3 画像認識機能
- **要件ID**: REQ-003
- **説明**: YOLOモデルによる物体検出と薬液識別
- **詳細**:
  - リアルタイム物体検出
  - 次亜塩素酸ナトリウムボトル認識
  - 酢酸ボトル認識
  - 蓋の開閉状態検出
  - 色付きテープによる識別

#### 1.1.4 安全確認機能
- **要件ID**: REQ-004
- **説明**: 選択した薬液と実際の操作の一致確認
- **詳細**:
  - 正しい薬液選択時の「◯」表示
  - 正解時のピンポン音再生
  - 誤った薬液選択時の「✕」表示
  - 誤答時のアラート音再生

### 1.2 学習データ要件

#### 1.2.1 ラベル付けデータ
- **要件ID**: REQ-005
- **説明**: labelImgを使用した学習データの準備
- **詳細**:
  - 次亜塩素酸ナトリウムボトル（蓋閉じ）のラベル付け
  - 次亜塩素酸ナトリウムボトル（蓋開き）のラベル付け
  - 酢酸ボトル（蓋閉じ）のラベル付け
  - 酢酸ボトル（蓋開き）のラベル付け
  - 各状態につき最低100枚の画像データ

#### 1.2.2 モデル学習
- **要件ID**: REQ-006
- **説明**: YOLOモデルのカスタム学習
- **詳細**:
  - 学習データの前処理
  - モデル学習の実行
  - 精度評価と調整
  - リアルタイム推論用の最適化

## 2. 非機能要件

### 2.1 性能要件

#### 2.1.1 リアルタイム処理
- **要件ID**: REQ-007
- **説明**: リアルタイムでの画像認識処理
- **詳細**:
  - フレームレート: 30fps以上
  - 認識遅延: 100ms以下
  - CPU使用率: 80%以下

#### 2.1.2 精度要件
- **要件ID**: REQ-008
- **説明**: 画像認識の精度要求
- **詳細**:
  - 薬液識別精度: 95%以上
  - 蓋開閉状態識別精度: 90%以上
  - 誤検出率: 5%以下

### 2.2 安全性要件

#### 2.2.1 誤操作防止
- **要件ID**: REQ-009
- **説明**: 薬液の誤操作を完全に防止
- **詳細**:
  - 誤操作検出率: 100%
  - 即座の警告表示
  - 明確な視覚・聴覚フィードバック

#### 2.2.2 信頼性
- **要件ID**: REQ-010
- **説明**: システムの安定動作
- **詳細**:
  - 連続動作時間: 8時間以上
  - クラッシュ率: 0.1%以下
  - エラー時の適切な復旧

### 2.3 操作性要件

#### 2.3.1 ユーザビリティ
- **要件ID**: REQ-011
- **説明**: 直感的で使いやすいインターフェース
- **詳細**:
  - ワンタップでの薬液選択
  - 明確な視覚的フィードバック
  - 音声ガイダンス

#### 2.3.2 アクセシビリティ
- **要件ID**: REQ-012
- **説明**: 様々な環境での使用可能性
- **詳細**:
  - 片手での操作可能
  - 明るさ調整機能
  - 音声音量調整

## 3. 技術要件

### 3.1 開発環境
- **要件ID**: REQ-013
- **説明**: 開発に使用する技術スタック
- **詳細**:
  - Python 3.10のみ使用
  - YOLOモデル（PyTorch/TensorFlow）
  - OpenCV（カメラ処理）
  - labelImg（ラベル付け）

### 3.2 プラットフォーム要件
- **要件ID**: REQ-014
- **説明**: 動作環境の要求
- **詳細**:
  - ローカルアプリケーション
  - サーバー不要
  - オフライン動作
  - 携帯端末対応

## 4. 制約事項

### 4.1 技術的制約
- Python 3.10以外の言語は使用不可
- 外部APIへの依存は最小限
- リアルタイム処理の必要性
- 限られた計算リソースでの動作

### 4.2 運用制約
- 1人作業での使用
- 医療現場での使用
- 安全性の最優先
- シンプルな操作フロー

## 5. 成功基準

### 5.1 機能面
- 薬液の正確な識別（95%以上）
- 誤操作の完全防止（100%）
- リアルタイム処理の実現
- 直感的な操作性

### 5.2 性能面
- 30fps以上の処理速度
- 100ms以下の認識遅延
- 安定した連続動作
- 低いCPU使用率

### 5.3 安全性面
- 誤操作検出率100%
- 即座の警告表示
- 明確なフィードバック
- 信頼性の高い動作
